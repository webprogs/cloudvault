import{r,j as e,a as H,b as q,c as $e,H as We,L as re}from"./app-Dmf9EGBP.js";import{A as Re}from"./AppLayout-BFK8zi9d.js";import{B as $}from"./Button-VU0GipWi.js";import{M as J}from"./Modal-CRolMPXu.js";function Te(t,l,s,o){var c=this,u=r.useRef(null),x=r.useRef(0),y=r.useRef(0),p=r.useRef(null),d=r.useRef([]),a=r.useRef(),i=r.useRef(),j=r.useRef(t),w=r.useRef(!0),C=r.useRef(),D=r.useRef();j.current=t;var W=typeof window<"u",L=!l&&l!==0&&W;if(typeof t!="function")throw new TypeError("Expected a function");l=+l||0;var n=!!(s=s||{}).leading,m=!("trailing"in s)||!!s.trailing,F=!!s.flushOnExit&&m,T="maxWait"in s,k="debounceOnServer"in s&&!!s.debounceOnServer,g=T?Math.max(+s.maxWait||0,l):null,v=r.useMemo(function(){var B=function(M){var E=d.current,_=a.current;return d.current=a.current=null,x.current=M,y.current=y.current||M,i.current=j.current.apply(_,E)},P=function(M,E){L&&cancelAnimationFrame(p.current),p.current=L?requestAnimationFrame(M):setTimeout(M,E)},V=function(M){if(!w.current)return!1;var E=M-u.current;return!u.current||E>=l||E<0||T&&M-x.current>=g},f=function(M){return p.current=null,m&&d.current?B(M):(d.current=a.current=null,i.current)},b=function M(){var E=Date.now();if(n&&y.current===x.current&&N(),V(E))return f(E);if(w.current){var _=l-(E-u.current),O=T?Math.min(_,g-(E-x.current)):_;P(M,O)}},N=function(){},S=function(){if(W||k){var M,E=Date.now(),_=V(E);if(d.current=[].slice.call(arguments),a.current=c,u.current=E,F&&!C.current&&(C.current=function(){var O;((O=global.document)==null?void 0:O.visibilityState)==="hidden"&&D.current.flush()},(M=global.document)==null||M.addEventListener==null||M.addEventListener("visibilitychange",C.current)),_){if(!p.current&&w.current)return x.current=u.current,P(b,l),n?B(u.current):i.current;if(T)return P(b,l),B(u.current)}return p.current||P(b,l),i.current}};return S.cancel=function(){var M=p.current;M&&(L?cancelAnimationFrame(p.current):clearTimeout(p.current)),x.current=0,d.current=u.current=a.current=p.current=null},S.isPending=function(){return!!p.current},S.flush=function(){return p.current?f(Date.now()):i.current},S},[n,T,l,g,m,F,L,W,k,o]);return D.current=v,r.useEffect(function(){return w.current=!0,function(){var B;F&&D.current.flush(),C.current&&((B=global.document)==null||B.removeEventListener==null||B.removeEventListener("visibilitychange",C.current),C.current=null),w.current=!1}},[F]),v}function Oe(t){const[l,s]=r.useState(!1),[o,c]=r.useState(!1),[u,x]=r.useState(null);r.useEffect(()=>{const d=window.SpeechRecognition||window.webkitSpeechRecognition;c(!!d)},[]);const y=r.useCallback(()=>{if(!o){x("Voice search is not supported in this browser");return}const d=window.SpeechRecognition||window.webkitSpeechRecognition,a=new d;a.continuous=!1,a.interimResults=!1,a.lang="en-US",a.onstart=()=>{s(!0),x(null)},a.onresult=i=>{const j=i.results[0][0].transcript;t(j),s(!1)},a.onerror=i=>{x(i.error==="not-allowed"?"Microphone access denied":"Voice search error: "+i.error),s(!1)},a.onend=()=>{s(!1)};try{a.start()}catch{x("Failed to start voice search"),s(!1)}},[o,t]),p=r.useCallback(()=>{s(!1)},[]);return{isListening:l,isSupported:o,error:u,startListening:y,stopListening:p}}function Ae({onResult:t}){const{isListening:l,isSupported:s,error:o,startListening:c}=Oe(t);return s?e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:c,disabled:l,className:`p-1.5 rounded-md transition-colors ${l?"text-primary bg-primary-light":"text-text-secondary hover:text-text-primary hover:bg-gray-100"}`,title:l?"Listening...":"Voice search",children:e.jsxs("div",{className:"relative",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),l&&e.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-error rounded-full voice-active"})]})}),o&&e.jsx("div",{className:"absolute top-full right-0 mt-2 px-3 py-2 bg-error text-white text-xs rounded-lg whitespace-nowrap z-10",children:o})]}):null}function Pe({initialValue:t="",placeholder:l="Search files..."}){const[s,o]=r.useState(t),[c,u]=r.useState(!1),x=Te(a=>{H.get(window.location.pathname,{...Object.fromEntries(new URLSearchParams(window.location.search)),search:a||void 0},{preserveState:!0,preserveScroll:!0})},300),y=a=>{const i=a.target.value;o(i),x(i)},p=r.useCallback(a=>{o(a),x(a)},[x]),d=()=>{o(""),x("")};return e.jsx("div",{className:"relative flex items-center",children:e.jsxs("div",{className:`relative flex-1 transition-all duration-200 ${c?"scale-[1.02]":""}`,children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx("svg",{className:`h-5 w-5 transition-colors ${c?"text-primary":"text-text-secondary"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",value:s,onChange:y,onFocus:()=>u(!0),onBlur:()=>u(!1),placeholder:l,className:`block w-full pl-12 pr-24 py-3 border rounded-xl bg-card text-text-primary placeholder-text-secondary transition-all duration-200 ${c?"border-primary ring-4 ring-primary/10 shadow-lg":"border-border hover:border-gray-300 shadow-sm"}`}),e.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 gap-1",children:[s&&e.jsx("button",{onClick:d,className:"p-2 rounded-lg text-text-secondary hover:text-text-primary hover:bg-gray-100 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx(Ae,{onResult:p})]})]})})}function ve({size:t="sm"}){const l={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"};return e.jsx("div",{className:"inline-flex items-center justify-center text-primary",title:"This file is shared",children:e.jsx("svg",{className:l[t],fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})})}function He({file:t,selected:l,onSelect:s,onContextMenu:o,onPreview:c,onDownload:u,onShare:x,onDragStart:y,onDragEnd:p}){const[d,a]=r.useState(!1),[i,j]=r.useState(!1),w=r.useRef(null);r.useEffect(()=>{const g=v=>{w.current&&!w.current.contains(v.target)&&j(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]);const C=g=>{const v={image:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),video:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),audio:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})}),document:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),archive:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}),file:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})};return v[g]||v.file},D={image:"text-green-500 bg-green-50",video:"text-purple-500 bg-purple-50",audio:"text-pink-500 bg-pink-50",document:"text-blue-500 bg-blue-50",archive:"text-yellow-500 bg-yellow-50",file:"text-gray-500 bg-gray-50"},W=t.icon_type==="image",L=t.icon_type==="video",n=W||L,m=g=>{g.ctrlKey||g.metaKey?s(t.id):n&&c&&c(t)},F=()=>{u&&u(t)},T=g=>{g.dataTransfer.setData("application/json",JSON.stringify({type:"file",id:t.id})),g.dataTransfer.effectAllowed="move",y&&y(t,"file")},k=()=>{p&&p()};return e.jsxs("div",{draggable:!0,onDragStart:T,onDragEnd:k,className:`group relative bg-card border rounded-2xl p-4 transition-all duration-200 cursor-pointer card-hover ${l?"border-primary ring-2 ring-primary/20 shadow-md":"border-border hover:border-primary/40 hover:shadow-lg"}`,onClick:m,onDoubleClick:F,onContextMenu:g=>{g.preventDefault(),o(g,t)},children:[e.jsx("div",{className:`absolute top-3 left-3 w-5 h-5 rounded-lg border-2 flex items-center justify-center transition-all duration-200 z-10 ${l?"bg-primary border-primary shadow-sm":"border-border bg-white opacity-0 group-hover:opacity-100 hover:border-primary/50"}`,onClick:g=>{g.stopPropagation(),s(t.id)},children:l&&e.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{className:"absolute top-3 right-3 z-10",ref:w,children:[e.jsx("button",{className:`p-1.5 rounded-xl transition-all duration-200 ${i?"bg-gray-100 opacity-100":"hover:bg-gray-100 opacity-0 group-hover:opacity-100"}`,onClick:g=>{g.stopPropagation(),j(!i)},children:e.jsx("svg",{className:"w-5 h-5 text-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})}),i&&e.jsxs("div",{className:"absolute right-0 mt-1 w-44 bg-card rounded-xl shadow-xl border border-border py-1.5 slide-up",children:[n&&c&&e.jsxs("button",{onClick:g=>{g.stopPropagation(),j(!1),c(t)},className:"w-full px-4 py-2.5 text-left text-sm text-text-primary hover:bg-gray-50 flex items-center gap-3",children:[e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Preview"]}),e.jsxs("button",{onClick:g=>{g.stopPropagation(),j(!1),u&&u(t)},className:"w-full px-4 py-2.5 text-left text-sm text-text-primary hover:bg-gray-50 flex items-center gap-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download"]}),x&&e.jsxs("button",{onClick:g=>{g.stopPropagation(),j(!1),x(t)},className:"w-full px-4 py-2.5 text-left text-sm text-text-primary hover:bg-gray-50 flex items-center gap-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"Share"]}),e.jsx("div",{className:"my-1.5 border-t border-border"}),e.jsxs("button",{onClick:g=>{g.stopPropagation(),j(!1),o(g,t)},className:"w-full px-4 py-2.5 text-left text-sm text-text-primary hover:bg-gray-50 flex items-center gap-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"More options..."]})]})]}),e.jsx("div",{className:"flex justify-center mb-4 mt-2",children:W&&!d?e.jsx("div",{className:"w-full h-32 rounded-xl overflow-hidden bg-gray-100 relative",children:e.jsx("img",{src:t.thumbnail_url||`/files/${t.id}/download`,alt:t.name,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105",onError:()=>a(!0)})}):L?e.jsxs("div",{className:"w-full h-32 rounded-xl overflow-hidden bg-gray-900 relative flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-12 h-12 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-white ml-0.5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M8 5v14l11-7z"})})})}),e.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center ${D.video}`,children:C("video")})]}):e.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center ${D[t.icon_type]} transition-transform duration-200 group-hover:scale-110`,children:C(t.icon_type)})}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1.5",children:[e.jsx("p",{className:"text-sm font-medium text-text-primary truncate max-w-[140px]",title:t.name,children:t.name}),t.is_shared&&e.jsx(ve,{size:"sm"})]}),e.jsx("p",{className:"text-xs text-text-secondary mt-1.5",children:t.formatted_size})]})]})}function Ve({folder:t,onOpen:l,onContextMenu:s,onDrop:o,onDragStart:c,onDragEnd:u,selected:x,onSelect:y,selectable:p}){const[d,a]=r.useState(!1),i=n=>{n.dataTransfer.setData("application/json",JSON.stringify({type:"folder",id:t.id})),n.dataTransfer.effectAllowed="move",c&&c(t,"folder")},j=()=>{a(!1),u&&u()},w=n=>{n.preventDefault(),n.dataTransfer.dropEffect="move"},C=n=>{n.preventDefault();try{n.dataTransfer.types.includes("application/json")&&a(!0)}catch{a(!0)}},D=n=>{n.currentTarget.contains(n.relatedTarget)||a(!1)},W=n=>{n.preventDefault(),a(!1);try{const m=JSON.parse(n.dataTransfer.getData("application/json"));if(m.type==="folder"&&m.id===t.id)return;o&&o(m.id,m.type,t.id)}catch(m){console.error("Drop error:",m)}},L=n=>{n.ctrlKey||n.metaKey?y&&(n.stopPropagation(),y(t.id)):l()};return e.jsxs("div",{draggable:!0,onDragStart:i,onDragEnd:j,onDragOver:w,onDragEnter:C,onDragLeave:D,onDrop:W,className:`group relative bg-card border rounded-2xl p-4 transition-all duration-200 cursor-pointer card-hover ${d?"border-primary ring-2 ring-primary/40 bg-primary-light/30":x?"border-primary ring-2 ring-primary/20 shadow-md":"border-border hover:border-primary/40 hover:shadow-lg"}`,onClick:L,onContextMenu:n=>{n.preventDefault(),s(n,t)},children:[p&&e.jsx("div",{className:`absolute top-3 left-3 w-5 h-5 rounded-lg border-2 flex items-center justify-center transition-all duration-200 z-10 ${x?"bg-primary border-primary shadow-sm":"border-border bg-white opacity-0 group-hover:opacity-100 hover:border-primary/50"}`,onClick:n=>{n.stopPropagation(),y&&y(t.id)},children:x&&e.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center bg-gradient-to-br from-primary-light to-blue-100 text-primary transition-transform duration-200 group-hover:scale-110 ${d?"scale-110":""}`,children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})})}),e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-sm font-medium text-text-primary truncate max-w-[140px] mx-auto",title:t.name,children:t.name})}),e.jsx("button",{className:"absolute top-3 right-3 p-1.5 rounded-xl opacity-0 group-hover:opacity-100 hover:bg-gray-100 transition-all duration-200",onClick:n=>{n.stopPropagation(),s(n,t)},children:e.jsx("svg",{className:"w-5 h-5 text-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})]})}function Ue({files:t,folders:l,selectedFiles:s,onSelectFile:o,onContextMenu:c,onOpenFolder:u,onFolderContextMenu:x,onPreview:y,onDownload:p,onShare:d,onDropToFolder:a,selectedFolders:i,onSelectFolder:j}){return t.length===0&&l.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-gray-100 to-gray-50 rounded-3xl flex items-center justify-center mb-6",children:e.jsx("svg",{className:"w-12 h-12 text-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"No files yet"}),e.jsx("p",{className:"text-text-secondary",children:"Upload files to get started"})]}):e.jsxs("div",{className:"space-y-6",children:[l.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-text-secondary mb-3",children:"Folders"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:l.map(w=>e.jsx(Ve,{folder:w,onOpen:()=>u(w.id),onContextMenu:x,onDrop:a,selected:i?.includes(w.id),onSelect:j,selectable:!!j},w.id))})]}),t.length>0&&e.jsxs("div",{children:[l.length>0&&e.jsx("h3",{className:"text-sm font-medium text-text-secondary mb-3",children:"Files"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:t.map(w=>e.jsx(He,{file:w,selected:s.includes(w.id),onSelect:o,onContextMenu:c,onPreview:y,onDownload:p,onShare:d},w.id))})]})]})}function Ge({files:t,folders:l,selectedFiles:s,onSelectFile:o,onContextMenu:c,onOpenFolder:u,onFolderContextMenu:x,sortBy:y,sortOrder:p,onSort:d,onDropToFolder:a,selectedFolders:i,onSelectFolder:j}){const[w,C]=r.useState(null),D=n=>{d(n)},W=n=>n!==y?null:e.jsx("svg",{className:`w-4 h-4 inline ml-1 transition-transform ${p==="desc"?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),L=n=>new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return t.length===0&&l.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-gray-100 to-gray-50 rounded-3xl flex items-center justify-center mb-6",children:e.jsx("svg",{className:"w-12 h-12 text-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"No files yet"}),e.jsx("p",{className:"text-text-secondary",children:"Upload files to get started"})]}):e.jsx("div",{className:"bg-card border border-border rounded-2xl overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50/80 border-b border-border",children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-10 px-4 py-4",children:e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded-md border-border cursor-pointer",checked:s.length===t.length&&t.length>0,onChange:()=>{s.length===t.length?o(null,!0):t.forEach(n=>o(n.id))}})}),e.jsxs("th",{className:"px-4 py-4 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider cursor-pointer hover:text-text-primary transition-colors",onClick:()=>D("name"),children:["Name ",W("name")]}),e.jsxs("th",{className:"px-4 py-4 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider cursor-pointer hover:text-text-primary transition-colors hidden sm:table-cell",onClick:()=>D("created_at"),children:["Date ",W("created_at")]}),e.jsxs("th",{className:"px-4 py-4 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider cursor-pointer hover:text-text-primary transition-colors hidden md:table-cell",onClick:()=>D("size"),children:["Size ",W("size")]}),e.jsx("th",{className:"w-10 px-4 py-4"})]})}),e.jsxs("tbody",{className:"divide-y divide-border/60",children:[l.map(n=>e.jsxs("tr",{draggable:!0,onDragStart:m=>{m.dataTransfer.setData("application/json",JSON.stringify({type:"folder",id:n.id})),m.dataTransfer.effectAllowed="move"},onDragOver:m=>{m.preventDefault(),m.dataTransfer.dropEffect="move"},onDragEnter:m=>{m.preventDefault(),C(n.id)},onDragLeave:m=>{m.currentTarget.contains(m.relatedTarget)||C(null)},onDrop:m=>{m.preventDefault(),C(null);try{const F=JSON.parse(m.dataTransfer.getData("application/json"));if(F.type==="folder"&&F.id===n.id)return;a&&a(F.id,F.type,n.id)}catch(F){console.error("Drop error:",F)}},className:`cursor-pointer transition-colors ${w===n.id?"bg-primary-light/50 ring-2 ring-primary/40":i?.includes(n.id)?"bg-primary-light/30":"hover:bg-gray-50/60"}`,onClick:m=>{m.ctrlKey||m.metaKey?j&&j(n.id):u(n.id)},onContextMenu:m=>{m.preventDefault(),x(m,n)},children:[e.jsx("td",{className:"px-4 py-4",children:j?e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded-md border-border cursor-pointer",checked:i?.includes(n.id),onChange:()=>j(n.id),onClick:m=>m.stopPropagation()}):e.jsx("div",{className:"w-5"})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-11 h-11 rounded-xl bg-gradient-to-br from-primary-light to-blue-100 flex items-center justify-center shrink-0 transition-transform ${w===n.id?"scale-110":""}`,children:e.jsx("svg",{className:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),e.jsx("span",{className:"font-medium text-text-primary",children:n.name})]})}),e.jsx("td",{className:"px-4 py-4 text-sm text-text-secondary hidden sm:table-cell",children:L(n.created_at)}),e.jsx("td",{className:"px-4 py-4 text-sm text-text-secondary hidden md:table-cell",children:"â€”"}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("button",{onClick:m=>{m.stopPropagation(),x(m,n)},className:"p-1.5 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})})]},`folder-${n.id}`)),t.map(n=>e.jsxs("tr",{draggable:!0,onDragStart:m=>{m.dataTransfer.setData("application/json",JSON.stringify({type:"file",id:n.id})),m.dataTransfer.effectAllowed="move"},className:`hover:bg-gray-50/60 transition-colors ${s.includes(n.id)?"bg-primary-light/30":""}`,onContextMenu:m=>{m.preventDefault(),c(m,n)},children:[e.jsx("td",{className:"px-4 py-4",children:e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded-md border-border cursor-pointer",checked:s.includes(n.id),onChange:()=>o(n.id)})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-11 h-11 rounded-xl bg-gray-100 flex items-center justify-center shrink-0",children:e.jsx("svg",{className:"w-5 h-5 text-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-medium text-text-primary truncate",children:n.name}),n.is_shared&&e.jsx(ve,{size:"sm"})]}),e.jsx("p",{className:"text-xs text-text-secondary uppercase",children:n.extension})]})]})}),e.jsx("td",{className:"px-4 py-4 text-sm text-text-secondary hidden sm:table-cell",children:L(n.created_at)}),e.jsx("td",{className:"px-4 py-4 text-sm text-text-secondary hidden md:table-cell",children:n.formatted_size}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("button",{onClick:m=>{m.stopPropagation(),c(m,n)},className:"p-1.5 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})})]},`file-${n.id}`))]})]})})}function Ke({files:t,uploadStates:l,onRemove:s,onCancel:o,onRetry:c,formatFileSize:u}){const x=d=>{switch(d){case"completed":return"text-green-600";case"error":return"text-red-600";case"cancelled":return"text-gray-500";case"processing":return"text-blue-600";default:return"text-primary"}},y=d=>{switch(d){case"initializing":return"Initializing...";case"uploading":return"Uploading...";case"processing":return"Processing...";case"completed":return"Completed";case"error":return"Failed";case"cancelled":return"Cancelled";default:return"Pending"}},p=d=>{switch(d){case"completed":return"bg-green-500";case"error":return"bg-red-500";case"cancelled":return"bg-gray-400";case"processing":return"bg-blue-500";default:return"bg-primary"}};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm font-medium text-text-primary",children:[t.length," file(s) selected"]}),e.jsx("div",{className:"max-h-64 overflow-y-auto space-y-3",children:t.map((d,a)=>{const i=l[a]||{status:"pending",progress:0},j=["initializing","uploading","processing"].includes(i.status);return e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 ${i.status==="completed"?"bg-green-100":i.status==="error"?"bg-red-100":"bg-primary-light"}`,children:i.status==="completed"?e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):i.status==="error"?e.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):j?e.jsxs("svg",{className:"w-5 h-5 text-primary animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsx("svg",{className:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-text-primary truncate",children:d.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("span",{className:"text-text-secondary",children:u(d.size)}),e.jsx("span",{className:`${x(i.status)}`,children:y(i.status)})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[i.status==="error"&&e.jsx("button",{onClick:()=>c(a),className:"p-1.5 text-primary hover:bg-primary-light rounded-lg transition-colors",title:"Retry",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),j&&e.jsx("button",{onClick:()=>o(a),className:"p-1.5 text-text-secondary hover:text-error hover:bg-red-50 rounded-lg transition-colors",title:"Cancel",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),!j&&e.jsx("button",{onClick:()=>s(a),className:"p-1.5 text-text-secondary hover:text-error hover:bg-red-50 rounded-lg transition-colors",title:"Remove",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),(j||i.status==="completed")&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-text-secondary",children:i.status==="processing"?"Processing on server...":i.status==="completed"?"Upload complete":`Uploading chunk ${i.uploadedChunks||0} of ${i.totalChunks||"?"}`}),e.jsxs("span",{className:"text-text-primary font-medium",children:[Math.round(i.progress||0),"%"]})]}),e.jsx("div",{className:"h-1.5 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-300 ${p(i.status)} ${i.status==="processing"?"animate-pulse":""}`,style:{width:`${i.progress||0}%`}})})]}),i.status==="error"&&i.error&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:i.error})]},`${d.name}-${a}`)})})]})}const Ie=3;function Je({folderId:t,onClose:l,onUploadComplete:s}){const[o,c]=r.useState([]),[u,x]=r.useState({}),[y,p]=r.useState(!1),[d,a]=r.useState(!1),i=r.useRef(null),j=r.useRef({});r.useEffect(()=>()=>{Object.values(j.current).forEach(f=>{f?.abort()})},[]);const w=r.useCallback(f=>{f.preventDefault(),p(!0)},[]),C=r.useCallback(f=>{f.preventDefault(),p(!1)},[]),D=r.useCallback(f=>{f.preventDefault(),p(!1);const b=Array.from(f.dataTransfer.files);L(b)},[]),W=f=>{const b=Array.from(f.target.files);L(b),f.target.value=""},L=f=>{c(b=>{const N=new Set(b.map(M=>M.name)),S=f.filter(M=>!N.has(M.name));return[...b,...S]})},n=f=>{o[f],u[f]?.sessionId&&g(f),c(b=>b.filter((N,S)=>S!==f)),x(b=>{const N={...b};return delete N[f],N})},m=f=>{if(f===0)return"0 B";const b=1024,N=["B","KB","MB","GB","TB"],S=Math.floor(Math.log(f)/Math.log(b));return parseFloat((f/Math.pow(b,S)).toFixed(2))+" "+N[S]},F=async(f,b)=>{try{j.current[b]=new AbortController,x(_=>({..._,[b]:{status:"initializing",progress:0,error:null}}));const N=await q.post("/api/uploads/initiate",{filename:f.name,file_size:f.size,folder_id:t},{signal:j.current[b]?.signal}),{session_id:S,chunk_size:M,total_chunks:E}=N.data;x(_=>({..._,[b]:{sessionId:S,status:"uploading",progress:0,uploadedChunks:[],totalChunks:E,chunkSize:M,error:null}})),await T(f,b,S,M,E)}catch(N){if(q.isCancel(N))return;x(S=>({...S,[b]:{...S[b],status:"error",error:N.response?.data?.message||N.response?.data?.errors?.[0]||"Failed to initialize upload"}}))}},T=async(f,b,N,S,M)=>{const E=[];for(let R=0;R<M;R++){const U=R*S,I=Math.min(U+S,f.size);E.push({index:R,start:U,end:I})}const _=[...E],O=new Set,G=async()=>{for(;_.length>0||O.size>0;){if(j.current[b]?.signal?.aborted)return;for(;O.size<Ie&&_.length>0;){const R=_.shift(),U=k(f,b,N,R).catch(I=>{if(!q.isCancel(I))if(!R.retries||R.retries<3)R.retries=(R.retries||0)+1,_.push(R);else throw I}).finally(()=>{O.delete(U)});O.add(U)}O.size>0&&await Promise.race(O)}};try{await G()}catch(R){q.isCancel(R)||x(U=>({...U,[b]:{...U[b],status:"error",error:R.response?.data?.message||"Upload failed"}}))}},k=async(f,b,N,S)=>{const M=f.slice(S.start,S.end),E=new FormData;E.append("chunk",M),E.append("chunk_index",S.index);const _=await q.post(`/api/uploads/${N}/chunk`,E,{headers:{"Content-Type":"multipart/form-data"},signal:j.current[b]?.signal});return x(O=>{const G=O[b];if(!G)return O;const R=_.data.status==="assembling"?"processing":_.data.status==="completed"?"completed":"uploading";return{...O,[b]:{...G,progress:_.data.progress,uploadedChunks:_.data.uploaded_chunks,status:R}}}),_.data.status==="completed"&&s?.(),_.data},g=async f=>{const b=u[f];if(b?.sessionId){j.current[f]?.abort();try{await q.delete(`/api/uploads/${b.sessionId}`)}catch{}x(N=>({...N,[f]:{...N[f],status:"cancelled"}}))}},v=async f=>{const b=o[f];b&&(j.current[f]=new AbortController,x(N=>({...N,[f]:{status:"initializing",progress:0,error:null}})),await F(b,f))},B=async()=>{if(o.length===0||d)return;a(!0);const f=o.map((b,N)=>{const S=u[N];return S?.status==="completed"||S?.status==="uploading"||S?.status==="processing"?Promise.resolve():F(b,N)});await Promise.allSettled(f),a(!1)},P=o.length>0&&o.every((f,b)=>u[b]?.status==="completed");Object.values(u).some(f=>f?.status==="error");const V=Object.values(u).some(f=>f?.status==="uploading"||f?.status==="processing"||f?.status==="initializing");return e.jsxs("div",{className:"space-y-4",children:[!d&&!V&&e.jsxs("div",{onDragOver:w,onDragLeave:C,onDrop:D,onClick:()=>i.current?.click(),className:`border-2 border-dashed rounded-xl p-8 text-center cursor-pointer transition-all ${y?"border-primary bg-primary-light dropzone-active":"border-border hover:border-primary hover:bg-gray-50"}`,children:[e.jsx("input",{ref:i,type:"file",multiple:!0,onChange:W,className:"hidden"}),e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center ${y?"bg-primary text-white":"bg-primary-light text-primary"}`,children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-text-primary font-medium",children:y?"Drop files here":"Drag & drop files here"}),e.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"or click to browse"})]}),e.jsx("p",{className:"text-xs text-text-secondary",children:"Maximum file size: 10GB (large files upload in chunks)"})]})]}),o.length>0&&e.jsx(Ke,{files:o,uploadStates:u,onRemove:n,onCancel:g,onRetry:v,formatFileSize:m}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-border",children:[e.jsx($,{variant:"ghost",onClick:l,children:P?"Close":"Cancel"}),!P&&e.jsx($,{onClick:B,disabled:o.length===0||V,loading:V,children:V?"Uploading...":`Upload ${o.length>0?`(${o.length})`:""}`}),P&&e.jsx($,{onClick:()=>{s?.(),l?.()},children:"Done"})]})]})}const se=100*1024*1024;function Xe({folderId:t,onClose:l}){const[s,o]=r.useState([]),[c,u]=r.useState(!1),[x,y]=r.useState(!1),[p,d]=r.useState({}),[a,i]=r.useState(!1),j=r.useRef(null),w=r.useCallback(k=>{k.preventDefault(),u(!0)},[]),C=r.useCallback(k=>{k.preventDefault(),u(!1)},[]),D=r.useCallback(k=>{k.preventDefault(),u(!1);const g=Array.from(k.dataTransfer.files);L(g)},[]),W=k=>{const g=Array.from(k.target.files);L(g),k.target.value=""},L=k=>{k.some(v=>v.size>se)?(i(!0),o(v=>[...v,...k])):o(v=>[...v,...k])},n=k=>{o(g=>{const v=g.filter((B,P)=>P!==k);return v.some(B=>B.size>se)||i(!1),v})},m=k=>{if(k===0)return"0 B";const g=1024,v=["B","KB","MB","GB","TB"],B=Math.floor(Math.log(k)/Math.log(g));return parseFloat((k/Math.pow(g,B)).toFixed(2))+" "+v[B]},F=()=>{if(s.length===0)return;y(!0);const k=new FormData;s.forEach(g=>{k.append("files[]",g)}),t&&k.append("folder_id",t),H.post("/files/upload",k,{forceFormData:!0,onProgress:g=>{d({percentage:g.percentage})},onSuccess:()=>{o([]),y(!1),l?.()},onError:()=>{y(!1)}})},T=()=>{H.reload({only:["files","stats"]})};return a||s.some(k=>k.size>se)?e.jsx(Je,{folderId:t,onClose:()=>{o([]),i(!1),l?.()},onUploadComplete:T}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{onDragOver:w,onDragLeave:C,onDrop:D,onClick:()=>j.current?.click(),className:`border-2 border-dashed rounded-xl p-8 text-center cursor-pointer transition-all ${c?"border-primary bg-primary-light dropzone-active":"border-border hover:border-primary hover:bg-gray-50"}`,children:[e.jsx("input",{ref:j,type:"file",multiple:!0,onChange:W,className:"hidden"}),e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center ${c?"bg-primary text-white":"bg-primary-light text-primary"}`,children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-text-primary font-medium",children:c?"Drop files here":"Drag & drop files here"}),e.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"or click to browse"})]}),e.jsx("p",{className:"text-xs text-text-secondary",children:"Files up to 10GB supported (large files use chunked upload)"})]})]}),s.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm font-medium text-text-primary",children:[s.length," file(s) selected"]}),e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-2",children:s.map((k,g)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-light rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{className:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-text-primary truncate",children:k.name}),e.jsx("p",{className:"text-xs text-text-secondary",children:m(k.size)})]})]}),!x&&e.jsx("button",{onClick:()=>n(g),className:"p-1 text-text-secondary hover:text-error transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},g))})]}),x&&p.percentage!==void 0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-text-secondary",children:"Uploading..."}),e.jsxs("span",{className:"text-text-primary font-medium",children:[Math.round(p.percentage),"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary transition-all duration-300",style:{width:`${p.percentage}%`}})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-border",children:[e.jsx($,{variant:"ghost",onClick:l,children:"Cancel"}),e.jsxs($,{onClick:F,disabled:s.length===0,loading:x,children:["Upload ",s.length>0&&`(${s.length})`]})]})]})}function qe({x:t,y:l,file:s,onClose:o,onDownload:c,onRename:u,onDelete:x,onMove:y,onShare:p}){const d=r.useRef(null);return r.useEffect(()=>{const a=j=>{d.current&&!d.current.contains(j.target)&&o()},i=j=>{j.key==="Escape"&&o()};return document.addEventListener("mousedown",a),document.addEventListener("keydown",i),()=>{document.removeEventListener("mousedown",a),document.removeEventListener("keydown",i)}},[o]),r.useEffect(()=>{if(d.current){const a=d.current.getBoundingClientRect(),i=window.innerWidth,j=window.innerHeight;a.right>i&&(d.current.style.left=`${t-a.width}px`),a.bottom>j&&(d.current.style.top=`${l-a.height}px`)}},[t,l]),e.jsxs("div",{ref:d,className:"fixed z-50 bg-card rounded-lg shadow-lg border border-border py-1 min-w-[180px]",style:{left:t,top:l},children:[e.jsxs("button",{onClick:()=>{c(s),o()},className:"w-full px-4 py-2 text-left text-sm text-text-primary hover:bg-gray-50 flex items-center gap-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download"]}),e.jsxs("button",{onClick:()=>{p(s),o()},className:"w-full px-4 py-2 text-left text-sm text-text-primary hover:bg-gray-50 flex items-center gap-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"Share"]}),e.jsx("div",{className:"my-1 border-t border-border"}),e.jsxs("button",{onClick:()=>{u(s),o()},className:"w-full px-4 py-2 text-left text-sm text-text-primary hover:bg-gray-50 flex items-center gap-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Rename"]}),e.jsxs("button",{onClick:()=>{y(s),o()},className:"w-full px-4 py-2 text-left text-sm text-text-primary hover:bg-gray-50 flex items-center gap-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),"Move to..."]}),e.jsx("div",{className:"my-1 border-t border-border"}),e.jsxs("button",{onClick:()=>{x(s),o()},className:"w-full px-4 py-2 text-left text-sm text-error hover:bg-red-50 flex items-center gap-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]})}const ae=()=>{const t=document.querySelector('meta[name="csrf-token"]');return t?t.getAttribute("content"):""};function Qe({isOpen:t,onClose:l,file:s,existingShare:o}){const[c,u]=r.useState("public"),[x,y]=r.useState(""),[p,d]=r.useState(""),[a,i]=r.useState(""),[j,w]=r.useState(!1),[C,D]=r.useState(o||null),[W,L]=r.useState(!1),[n,m]=r.useState("");r.useEffect(()=>{o?(D(o),u(o.share_type),d(o.expires_at?o.expires_at.slice(0,16):""),i(o.max_downloads?.toString()||"")):(D(null),u("public"),y(""),d(""),i("")),m("")},[o,t]);const F=async v=>{v.preventDefault(),w(!0),m("");try{const B=await fetch(`/shares/files/${s.id}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":ae()},body:JSON.stringify({share_type:c,password:c==="password"?x:null,expires_at:p||null,max_downloads:a?parseInt(a):null})}),P=await B.json();if(!B.ok)throw new Error(P.message||"Failed to create share link");D(P.share)}catch(B){m(B.message)}finally{w(!1)}},T=async()=>{if(C){w(!0),m("");try{const v=await fetch(`/shares/${C.id}`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":ae()},body:JSON.stringify({share_type:c,password:c==="password"&&x?x:null,expires_at:p||null,max_downloads:a?parseInt(a):null})}),B=await v.json();if(!v.ok)throw new Error(B.message||"Failed to update share");D(B.share)}catch(v){m(v.message)}finally{w(!1)}}},k=async()=>{if(C){w(!0),m("");try{const v=await fetch(`/shares/${C.id}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":ae()}});if(!v.ok){const B=await v.json();throw new Error(B.message||"Failed to revoke share")}D(null),u("public"),y(""),d(""),i("")}catch(v){m(v.message)}finally{w(!1)}}},g=async()=>{if(C?.share_url)try{await navigator.clipboard.writeText(C.share_url),L(!0),setTimeout(()=>L(!1),2e3)}catch{const v=document.createElement("textarea");v.value=C.share_url,document.body.appendChild(v),v.select(),document.execCommand("copy"),document.body.removeChild(v),L(!0),setTimeout(()=>L(!1),2e3)}};return e.jsx(J,{isOpen:t,onClose:l,title:`Share "${s?.name}"`,size:"md",children:e.jsxs("div",{className:"space-y-6",children:[n&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-xl text-sm text-error",children:n}),C?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary",children:"Share Link"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",readOnly:!0,value:C.share_url,className:"flex-1 px-4 py-2.5 border border-border rounded-xl bg-gray-50 text-text-primary text-sm"}),e.jsx($,{variant:W?"secondary":"primary",onClick:g,children:W?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-xl",children:[e.jsx("p",{className:"text-xs text-text-secondary uppercase tracking-wider",children:"Downloads"}),e.jsxs("p",{className:"text-2xl font-semibold text-text-primary mt-1",children:[C.access_count,C.max_downloads&&e.jsxs("span",{className:"text-sm font-normal text-text-secondary",children:[" / ",C.max_downloads]})]})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-xl",children:[e.jsx("p",{className:"text-xs text-text-secondary uppercase tracking-wider",children:"Expires"}),e.jsx("p",{className:"text-lg font-semibold text-text-primary mt-1",children:C.expires_at?new Date(C.expires_at).toLocaleDateString():"Never"})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-border",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary",children:"Update Settings"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm text-text-secondary",children:"Access Type"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"shareType",value:"public",checked:c==="public",onChange:v=>u(v.target.value),className:"text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm text-text-primary",children:"Public"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"shareType",value:"password",checked:c==="password",onChange:v=>u(v.target.value),className:"text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm text-text-primary",children:"Password Protected"})]})]})]}),c==="password"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm text-text-secondary",children:["New Password ",C.share_type==="password"&&"(leave blank to keep current)"]}),e.jsx("input",{type:"password",value:x,onChange:v=>y(v.target.value),className:"w-full px-4 py-2.5 border border-border rounded-xl focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Enter password"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm text-text-secondary",children:"Expires At"}),e.jsx("input",{type:"datetime-local",value:p,onChange:v=>d(v.target.value),className:"w-full px-4 py-2.5 border border-border rounded-xl focus:outline-none focus:ring-2 focus:ring-primary"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm text-text-secondary",children:"Max Downloads"}),e.jsx("input",{type:"number",value:a,onChange:v=>i(v.target.value),className:"w-full px-4 py-2.5 border border-border rounded-xl focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Unlimited",min:"1"})]})]})]}),e.jsxs("div",{className:"flex justify-between pt-4",children:[e.jsx($,{variant:"danger",onClick:k,loading:j,children:"Revoke Link"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx($,{variant:"ghost",onClick:l,children:"Close"}),e.jsx($,{onClick:T,loading:j,children:"Update"})]})]})]}):e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary",children:"Access Type"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>u("public"),className:`p-4 rounded-xl border-2 text-left transition-all ${c==="public"?"border-primary bg-primary-light":"border-border hover:border-primary/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${c==="public"?"bg-primary text-white":"bg-gray-100 text-text-secondary"}`,children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("span",{className:"font-medium text-text-primary",children:"Public"})]}),e.jsx("p",{className:"text-xs text-text-secondary",children:"Anyone with the link can download"})]}),e.jsxs("button",{type:"button",onClick:()=>u("password"),className:`p-4 rounded-xl border-2 text-left transition-all ${c==="password"?"border-primary bg-primary-light":"border-border hover:border-primary/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${c==="password"?"bg-primary text-white":"bg-gray-100 text-text-secondary"}`,children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),e.jsx("span",{className:"font-medium text-text-primary",children:"Password"})]}),e.jsx("p",{className:"text-xs text-text-secondary",children:"Requires password to download"})]})]})]}),c==="password"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary",children:"Password"}),e.jsx("input",{type:"password",value:x,onChange:v=>y(v.target.value),className:"w-full px-4 py-2.5 border border-border rounded-xl focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Enter a secure password",required:c==="password",minLength:4})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary",children:"Expires At"}),e.jsx("input",{type:"datetime-local",value:p,onChange:v=>d(v.target.value),className:"w-full px-4 py-2.5 border border-border rounded-xl focus:outline-none focus:ring-2 focus:ring-primary"}),e.jsx("p",{className:"text-xs text-text-secondary",children:"Leave empty for no expiration"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary",children:"Max Downloads"}),e.jsx("input",{type:"number",value:a,onChange:v=>i(v.target.value),className:"w-full px-4 py-2.5 border border-border rounded-xl focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Unlimited",min:"1"}),e.jsx("p",{className:"text-xs text-text-secondary",children:"Leave empty for unlimited"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx($,{type:"button",variant:"ghost",onClick:l,children:"Cancel"}),e.jsx($,{type:"submit",loading:j,children:"Create Share Link"})]})]})]})})}function Ye({file:t,onClose:l,onDownload:s,onShare:o}){const[c,u]=r.useState(!0),[x,y]=r.useState(!1);if(r.useEffect(()=>{const j=w=>{w.key==="Escape"&&l()};return document.addEventListener("keydown",j),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",j),document.body.style.overflow="unset"}},[l]),!t)return null;const p=t.icon_type==="image",d=t.icon_type==="video",a=()=>{u(!1)},i=()=>{u(!1),y(!0)};return $e.createPortal(e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-sm fade-in",onClick:l}),e.jsx("button",{onClick:l,className:"absolute top-4 right-4 z-10 p-2 rounded-xl bg-white/10 text-white hover:bg-white/20 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("div",{className:"absolute top-4 left-4 z-10 flex items-center gap-3",children:e.jsxs("div",{className:"px-4 py-2 rounded-xl bg-white/10 backdrop-blur-sm",children:[e.jsx("p",{className:"text-white font-medium truncate max-w-md",children:t.name}),e.jsx("p",{className:"text-white/60 text-sm",children:t.formatted_size})]})}),e.jsxs("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 z-10 flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>s(t),className:"flex items-center gap-2 px-4 py-2.5 rounded-xl bg-white/10 text-white hover:bg-white/20 transition-colors backdrop-blur-sm",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download"]}),o&&e.jsxs("button",{onClick:()=>{l(),o(t)},className:"flex items-center gap-2 px-4 py-2.5 rounded-xl bg-white/10 text-white hover:bg-white/20 transition-colors backdrop-blur-sm",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"Share"]})]}),e.jsxs("div",{className:"relative max-w-[90vw] max-h-[85vh] modal-enter",children:[c&&!x&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-12 h-12 border-4 border-white/20 border-t-white rounded-full animate-spin"})}),x&&e.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-white/10 rounded-2xl flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-10 h-10 text-white/60",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("p",{className:"text-white font-medium mb-1",children:"Unable to load preview"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Download the file to view it"})]}),p&&e.jsx("img",{src:`/files/${t.id}/download`,alt:t.name,className:`max-w-full max-h-[85vh] object-contain rounded-lg shadow-2xl ${c?"opacity-0":"opacity-100"} transition-opacity duration-300`,onLoad:a,onError:i}),d&&e.jsx("video",{src:`/files/${t.id}/download`,controls:!0,autoPlay:!0,className:`max-w-full max-h-[85vh] rounded-lg shadow-2xl ${c?"opacity-0":"opacity-100"} transition-opacity duration-300`,onLoadedData:a,onError:i})]})]}),document.body)}function je({folder:t,selectedId:l,onSelect:s,disabledIds:o,level:c=0}){const[u,x]=r.useState(!0),y=t.children&&t.children.length>0,p=o.includes(t.id),d=l===t.id;return e.jsxs("div",{children:[e.jsxs("div",{className:`flex items-center gap-2 py-2 px-3 rounded-lg cursor-pointer transition-colors ${p?"opacity-50 cursor-not-allowed":d?"bg-primary text-white":"hover:bg-gray-100"}`,style:{paddingLeft:`${c*16+12}px`},onClick:()=>{p||s(t.id)},children:[y?e.jsx("button",{onClick:a=>{a.stopPropagation(),x(!u)},className:`p-0.5 rounded transition-colors ${d?"hover:bg-white/20":"hover:bg-gray-200"}`,children:e.jsx("svg",{className:`w-4 h-4 transition-transform ${u?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):e.jsx("div",{className:"w-5"}),e.jsx("svg",{className:"w-5 h-5 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),e.jsx("span",{className:"truncate text-sm font-medium",children:t.name})]}),y&&u&&e.jsx("div",{children:t.children.map(a=>e.jsx(je,{folder:a,selectedId:l,onSelect:s,disabledIds:o,level:c+1},a.id))})]})}function Ze({folders:t,selectedId:l,onSelect:s,disabledIds:o=[]}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:`flex items-center gap-2 py-2 px-3 rounded-lg cursor-pointer transition-colors ${l===null?"bg-primary text-white":"hover:bg-gray-100"}`,onClick:()=>s(null),children:[e.jsx("div",{className:"w-5"}),e.jsx("svg",{className:"w-5 h-5 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),e.jsx("span",{className:"text-sm font-medium",children:"My Files (Root)"})]}),t.map(c=>e.jsx(je,{folder:c,selectedId:l,onSelect:s,disabledIds:o},c.id))]})}function et({isOpen:t,onClose:l,item:s,itemType:o,onMove:c,currentFolderId:u}){const[x,y]=r.useState([]),[p,d]=r.useState(u),[a,i]=r.useState(!1),[j,w]=r.useState(!0);r.useEffect(()=>{t&&(w(!0),d(u),fetch("/folders/tree",{headers:{Accept:"application/json"}}).then(L=>L.json()).then(L=>{y(L.folders||[])}).catch(console.error).finally(()=>w(!1)))},[t,u]);const C=()=>{if(o!=="folder"||!s)return[];const L=[s.id],n=m=>{m.forEach(F=>{if(F.id===s.id){const T=k=>{k.forEach(g=>{L.push(g.id),g.children&&T(g.children)})};F.children&&T(F.children)}else F.children&&n(F.children)})};return n(x),L},D=async()=>{i(!0);try{await c(s.id,o,p),l()}catch(L){console.error("Move failed:",L)}finally{i(!1)}},W=p===u;return e.jsx(J,{isOpen:t,onClose:l,title:`Move ${s?.name||""}`,children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-text-secondary",children:"Select a destination folder:"}),j?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("svg",{className:"animate-spin h-6 w-6 text-primary",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):e.jsx("div",{className:"max-h-64 overflow-y-auto border border-border rounded-lg p-2",children:e.jsx(Ze,{folders:x,selectedId:p,onSelect:d,disabledIds:C()})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx($,{variant:"ghost",onClick:l,children:"Cancel"}),e.jsx($,{onClick:D,disabled:a||W,children:a?"Moving...":"Move"})]})]})})}function tt({isOpen:t,onClose:l,selectedFolders:s,onSubmit:o}){const[c,u]=r.useState(""),[x,y]=r.useState(!1),p=async a=>{if(a.preventDefault(),!!c.trim()){y(!0);try{await o(c.trim()),u(""),l()}catch(i){console.error("Group failed:",i)}finally{y(!1)}}},d=()=>{u(""),l()};return e.jsx(J,{isOpen:t,onClose:d,title:"Group Folders",children:e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-text-secondary",children:"Create a new folder containing the selected folders:"}),e.jsx("div",{className:"max-h-32 overflow-y-auto border border-border rounded-lg p-3 bg-gray-50",children:e.jsx("ul",{className:"space-y-1",children:s.map(a=>e.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[e.jsx("svg",{className:"w-4 h-4 text-primary shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),e.jsx("span",{className:"text-text-primary truncate",children:a.name})]},a.id))})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"New Folder Name"}),e.jsx("input",{type:"text",value:c,onChange:a=>u(a.target.value),className:"w-full px-4 py-2.5 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Enter folder name",autoFocus:!0})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx($,{variant:"ghost",type:"button",onClick:d,children:"Cancel"}),e.jsx($,{type:"submit",disabled:!c.trim()||x,children:x?"Creating...":"Group Folders"})]})]})})}function rt(t="created_at",l="desc"){const[s,o]=r.useState(t),[c,u]=r.useState(l),x=[{value:"name",label:"Name"},{value:"created_at",label:"Date uploaded"},{value:"size",label:"Size"},{value:"extension",label:"Type"}],y=r.useCallback(d=>{let a="asc";d===s?a=c==="asc"?"desc":"asc":a=d==="created_at"||d==="size"?"desc":"asc",o(d),u(a),H.get(window.location.pathname,{...Object.fromEntries(new URLSearchParams(window.location.search)),sort_by:d,sort_order:a},{preserveState:!0,preserveScroll:!0})},[s,c]),p=r.useCallback(d=>d!==s?null:c==="asc"?"â†‘":"â†“",[s,c]);return{sortBy:s,sortOrder:c,sortOptions:x,handleSort:y,getSortIcon:p}}function lt({files:t,folders:l,currentFolder:s,breadcrumbs:o,filters:c,stats:u}){const[x,y]=r.useState("grid"),[p,d]=r.useState([]),[a,i]=r.useState(!1),[j,w]=r.useState(!1),[C,D]=r.useState(!1),[W,L]=r.useState(!1),[n,m]=r.useState(!1),[F,T]=r.useState(null),[k,g]=r.useState(null),[v,B]=r.useState(null),[P,V]=r.useState(null),[f,b]=r.useState(null),[N,S]=r.useState(null),[M,E]=r.useState(null),[_,O]=r.useState(""),[G,R]=r.useState(""),[U,I]=r.useState(!1),[Q,ne]=r.useState(null),[oe,le]=r.useState(null),[X,ie]=r.useState([]),[ye,ce]=r.useState(!1),{sortBy:be,sortOrder:we,handleSort:ke}=rt(c.sort_by||"created_at",c.sort_order||"desc"),de=r.useCallback((h,z=!1)=>{if(z){d([]);return}d(A=>A.includes(h)?A.filter(K=>K!==h):[...A,h])},[]),ue=r.useCallback((h,z)=>{h.preventDefault(),V({x:h.clientX,y:h.clientY}),S(z)},[]),he=r.useCallback((h,z)=>{h.preventDefault(),b({x:h.clientX,y:h.clientY}),S(z)},[]),Y=h=>{H.get("/files",{folder_id:h})},Z=h=>{window.location.href=`/files/${h.id}/download`},Ne=h=>{B(h)},xe=h=>{S(h),R(h.name),D(!0)},me=h=>{E(h),L(!0)},pe=(h,z=!1)=>{ne(h),le(z?"folder":"file"),I(!0)},Ce=(h,z,A)=>new Promise((K,te)=>{const Be=z==="file"?`/files/${h}/move`:`/folders/${h}/move`,Ee=z==="file"?{folder_id:A}:{parent_id:A};H.patch(Be,Ee,{onSuccess:()=>K(),onError:_e=>te(_e)})}),ge=(h,z,A)=>{const K=z==="file"?`/files/${h}/move`:`/folders/${h}/move`,te=z==="file"?{folder_id:A}:{parent_id:A};H.patch(K,te)},fe=r.useCallback(h=>{ie(z=>z.includes(h)?z.filter(A=>A!==h):[...z,h])},[]),Le=h=>new Promise((z,A)=>{H.post("/folders/group",{folder_ids:X,name:h,parent_id:s?.id||null},{onSuccess:()=>{ie([]),z()},onError:K=>A(K)})}),ee=async h=>{T(h),g(null);try{const A=await(await fetch(`/shares/files/${h.id}`,{headers:{Accept:"application/json"}})).json();A.share&&g(A.share)}catch{}m(!0)},Me=h=>{h.preventDefault(),H.post("/folders",{name:_,parent_id:s?.id||null},{onSuccess:()=>{w(!1),O("")}})},Se=h=>{h.preventDefault();const z=!N.extension,A=z?`/folders/${N.id}`:`/files/${N.id}/rename`;H["patch"](A,{name:G},{onSuccess:()=>{D(!1),S(null),R("")}})},De=()=>{if(!M)return;const z=!M.extension?`/folders/${M.id}`:`/files/${M.id}`;H.delete(z,{onSuccess:()=>{L(!1),E(null)}})},ze=()=>{p.length!==0&&H.post("/files/bulk-delete",{file_ids:p},{onSuccess:()=>d([])})},Fe=h=>{H.get("/files",{...Object.fromEntries(new URLSearchParams(window.location.search)),folder_id:s?.id,type:h==="all"?void 0:h},{preserveState:!0})};return e.jsxs(Re,{title:"My Files",children:[e.jsx(We,{title:"My Files"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs($,{onClick:()=>i(!0),children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Upload"]}),e.jsxs($,{variant:"secondary",onClick:()=>w(!0),children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z"})}),"New Folder"]}),p.length>0&&e.jsxs($,{variant:"danger",onClick:ze,children:["Delete (",p.length,")"]}),X.length>=2&&e.jsxs($,{variant:"secondary",onClick:()=>ce(!0),children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Group (",X.length,")"]})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[e.jsx("div",{className:"flex-1 sm:w-72",children:e.jsx(Pe,{initialValue:c.search||""})}),e.jsxs("div",{className:"flex items-center border border-border rounded-lg",children:[e.jsx("button",{onClick:()=>y("grid"),className:`p-2 ${x==="grid"?"bg-primary-light text-primary":"text-text-secondary hover:bg-gray-50"}`,children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),e.jsx("button",{onClick:()=>y("list"),className:`p-2 ${x==="list"?"bg-primary-light text-primary":"text-text-secondary hover:bg-gray-50"}`,children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(re,{href:"/files",className:"text-primary hover:text-primary-hover font-medium",children:"My Files"}),o.map((h,z)=>e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),z===o.length-1?e.jsx("span",{className:"text-text-primary font-medium",children:h.name}):e.jsx(re,{href:`/files?folder_id=${h.id}`,className:"text-primary hover:text-primary-hover",children:h.name})]},h.id))]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["all","image","video","audio","document","archive"].map(h=>e.jsx("button",{onClick:()=>Fe(h),className:`px-3 py-1.5 text-sm rounded-full transition-colors ${(c.type||"all")===h?"bg-primary text-white":"bg-gray-100 text-text-secondary hover:bg-gray-200"}`,children:h.charAt(0).toUpperCase()+h.slice(1)},h))}),e.jsxs("div",{className:"text-sm text-text-secondary",children:[u.file_count," files Â· ",u.total_size," used"]}),x==="grid"?e.jsx(Ue,{files:t.data,folders:l,selectedFiles:p,onSelectFile:de,onContextMenu:ue,onOpenFolder:Y,onFolderContextMenu:he,onPreview:Ne,onDownload:Z,onShare:ee,onDropToFolder:ge,selectedFolders:X,onSelectFolder:fe}):e.jsx(Ge,{files:t.data,folders:l,selectedFiles:p,onSelectFile:de,onContextMenu:ue,onOpenFolder:Y,onFolderContextMenu:he,sortBy:be,sortOrder:we,onSort:ke,onDropToFolder:ge,selectedFolders:X,onSelectFolder:fe}),t.last_page>1&&e.jsx("div",{className:"flex justify-center gap-2",children:t.links.map((h,z)=>e.jsx(re,{href:h.url||"#",className:`px-3 py-1 rounded ${h.active?"bg-primary text-white":h.url?"bg-gray-100 text-text-secondary hover:bg-gray-200":"bg-gray-50 text-gray-300 cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:h.label}},z))})]}),e.jsx(J,{isOpen:a,onClose:()=>i(!1),title:"Upload Files",size:"lg",children:e.jsx(Xe,{folderId:s?.id,onClose:()=>i(!1)})}),e.jsx(J,{isOpen:j,onClose:()=>w(!1),title:"Create New Folder",children:e.jsxs("form",{onSubmit:Me,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Folder Name"}),e.jsx("input",{type:"text",value:_,onChange:h=>O(h.target.value),className:"w-full px-4 py-2.5 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Enter folder name",autoFocus:!0})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx($,{variant:"ghost",onClick:()=>w(!1),children:"Cancel"}),e.jsx($,{type:"submit",disabled:!_.trim(),children:"Create"})]})]})}),e.jsx(J,{isOpen:C,onClose:()=>D(!1),title:`Rename ${N?.extension?"File":"Folder"}`,children:e.jsxs("form",{onSubmit:Se,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"New Name"}),e.jsx("input",{type:"text",value:G,onChange:h=>R(h.target.value),className:"w-full px-4 py-2.5 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",autoFocus:!0})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx($,{variant:"ghost",onClick:()=>D(!1),children:"Cancel"}),e.jsx($,{type:"submit",disabled:!G.trim(),children:"Rename"})]})]})}),e.jsx(J,{isOpen:W,onClose:()=>{L(!1),E(null)},title:`Delete ${M?.extension?"File":"Folder"}`,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-text-secondary",children:["Are you sure you want to delete ",e.jsx("strong",{children:M?.name}),"?",!M?.extension&&" All files inside will also be deleted.","This action cannot be undone."]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx($,{variant:"ghost",onClick:()=>L(!1),children:"Cancel"}),e.jsx($,{variant:"danger",onClick:De,children:"Delete"})]})]})}),P&&N&&e.jsx(qe,{x:P.x,y:P.y,file:N,onClose:()=>{V(null),S(null)},onDownload:Z,onRename:xe,onDelete:me,onMove:pe,onShare:ee}),e.jsx(Qe,{isOpen:n,onClose:()=>{m(!1),T(null),g(null)},file:F,existingShare:k}),v&&e.jsx(Ye,{file:v,onClose:()=>B(null),onDownload:Z,onShare:ee}),f&&N&&e.jsxs("div",{className:"fixed z-50 bg-card rounded-lg shadow-lg border border-border py-1 min-w-[180px]",style:{left:f.x,top:f.y},children:[e.jsxs("button",{onClick:()=>{Y(N.id),b(null)},className:"w-full px-4 py-2 text-left text-sm text-text-primary hover:bg-gray-50 flex items-center gap-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),"Open"]}),e.jsxs("button",{onClick:()=>{xe(N),b(null)},className:"w-full px-4 py-2 text-left text-sm text-text-primary hover:bg-gray-50 flex items-center gap-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Rename"]}),e.jsxs("button",{onClick:()=>{pe(N,!0),b(null),S(null)},className:"w-full px-4 py-2 text-left text-sm text-text-primary hover:bg-gray-50 flex items-center gap-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),"Move to..."]}),e.jsx("div",{className:"my-1 border-t border-border"}),e.jsxs("button",{onClick:()=>{me(N),b(null)},className:"w-full px-4 py-2 text-left text-sm text-error hover:bg-red-50 flex items-center gap-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]}),f&&e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>{b(null),S(null)}}),e.jsx(et,{isOpen:U,onClose:()=>{I(!1),ne(null),le(null)},item:Q,itemType:oe,onMove:Ce,currentFolderId:oe==="file"?Q?.folder_id:Q?.parent_id}),e.jsx(tt,{isOpen:ye,onClose:()=>ce(!1),selectedFolders:l.filter(h=>X.includes(h.id)),onSubmit:Le})]})}export{lt as default};
